buildscript {
    ext {
        springBootVersion = '2.0.1.RELEASE'
        appVersion = '0.1.0'
    }
    repositories {
        mavenCentral()
        maven { url 'https://plugins.gradle.org/m2/' }
    }
    dependencies {
        classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
        classpath('gradle.plugin.com.palantir.gradle.docker:gradle-docker:0.19.2')
    }
}

group = 'mspalti'
// group 'edu.willamette.cview.data'
version = "0.1.0"

apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'io.spring.dependency-management'
apply plugin: 'org.springframework.boot'
apply plugin: 'com.palantir.docker'

// When this task is executed via gradle, the 'docker' command is not found. However,
// if you manually execute the docker command that is generated by gradle
// you get a successful docker build (run command from within build/docker):
// "docker build --build-arg JAR_FILE=cview-data-0.1.0.jar -t mspalti/cview-data ."
// It looks like this may be an issue on the mac platform.
// Following this guide: https://spring.io/guides/gs/spring-boot-docker/
docker {
    name = "${project.group}/${bootJar.baseName}"
    files bootJar.archivePath
    buildArgs(['JAR_FILE': "${bootJar.archiveName}"])
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

bootJar {
    baseName = 'cview-data'
    version =  "0.1.0"
}

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
    implementation "org.springframework.boot:spring-boot-starter-hateoas:${springBootVersion}"
    implementation "org.springframework.boot:spring-boot-starter-cache:${springBootVersion}"
    implementation "org.springframework.boot:spring-boot-starter-actuator:${springBootVersion}"
    implementation "com.github.ben-manes.caffeine:caffeine:2.6.2"
    implementation "com.github.ben-manes.caffeine:guava:2.6.2"
    implementation "io.reactivex.rxjava2:rxjava:2.1.12"
    implementation group: 'org.apache.logging.log4j', name: 'log4j-api', version: '2.11.0'
    implementation group: 'org.apache.logging.log4j', name: 'log4j-core', version: '2.11.0'
    implementation group: 'com.google.code.gson', name: 'gson', version: '2.7'
}
